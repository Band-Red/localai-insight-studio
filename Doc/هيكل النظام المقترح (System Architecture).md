
يعتمد هيكل النظام (System Architecture) لمشروع **LocalAI Insight Studio** على تصميم "محلي أولاً" (Local-first Architecture)، حيث يتم الفصل بين واجهة المستخدم، ومنطق التحكم، ومحرك التحليل الإحصائي، مع ضمان الخصوصية الكاملة عبر تخزين البيانات في ملفات محلية بدلاً من السحب الإلكترونية.
![[deepseek_mermaid_20260210_eb4303.svg]]
###### إليك وصف مفصل للطبقات الأربع الرئيسية المكونة للنظام: 
---
### 1. طبقة العرض (Frontend Layer - React & TypeScript)

تعمل هذه الطبقة داخل بيئة **Electron Renderer Process**.

- **المكونات الأساسية:** واجهة المحادثة (Chat UI)، لوحة التحكم (Monitoring Dashboard)، والمحاكي (Interactive Sandbox).
    
- **إدارة التصميم:** يتم استخدام ملفات **CSS خارجية** مرتبطة بكل مكون لضمان خفة الوزن والتحكم الكامل في التصميم دون الاعتماد على أطر عمل ضخمة.
    
- **المعاينة (Preview Engine):** حاوية داخلية (Safe iframe) لعرض مشاريع الويب، ومحاكي بأبعاد محددة لعرض تطبيقات الجوال.


---

### 2. طبقة التحكم والأوركسترا (Orchestration Layer - Electron & Node.js)

تعمل بمثابة "العقل" الذي يربط كافة أجزاء النظام عبر **Main Process**.

- **جسر التواصل (IPC Bridge):** يؤمن نقل البيانات بين واجهة المستخدم ومنطق النظام الخلفي.
    
- **إدارة النماذج (Model Manager):** التحكم في تحميل النماذج (GGUF) وتخصيص موارد الذاكرة والـ GPU لها.
    
- **مراقب الملفات (File Watcher):** مراقبة التغييرات في مسارات الملفات التي يرفقها المستخدم وتحديث سياق النموذج فوراً.


---

### 3. طبقة التحليل والاستدلال (Analysis & Inference Layer)

تتكون من محركين يعملان بالتوازي لضمان الكفاءة:

- **محرك الاستدلال (Inference Engine):** يستخدم مكتبات مثل `node-llama-cpp` لتشغيل النموذج محلياً ومعالجة النصوص.
    
- **محرك التحليل (Python Analytics Engine):** سكربتات Python متخصصة يتم استدعاؤها لحساب المقاييس المعقدة مثل:
    
    - $KL \ Divergence$ لمراقبة الانحراف في DPO.
        
    - تحليل الانحدار (Regression) لمعدلات الهلوسة.
        
    - معالجة اللغات الطبيعية (NLP) لتقييم جودة المخرجات والاتساق.


---

### 4. طبقة البيانات (Data & Storage Layer - Local File System)

هذا هو الجزء الذي يميز مشروعك بالاستغناء عن قواعد البيانات التقليدية:

- **Storage Structure:**
    
    - **Config:** ملفات `.json` أو `.yaml` لإعدادات النموذج والواجهة.
        
    - **Logs:** سجلات الأداء الفني تُحفظ كملفات `.csv` لتسهيل قراءتها من قبل محرك Python.
        
    - **Context:** مجلدات تحتوي على ملفات الـ PDF والأكواد المرفقة التي يتم تحويلها إلى Embeddings محلية.
        
    - **Reports:** تصدير التقارير النهائية بصيغة **Markdown** لتكون جاهزة للاستخدام في تطبيق Obsidian.


---

### مخطط تدفق البيانات (Data Flow)

1. **الطلب:** يرسل المستخدم استفساراً أو يرفق ملفاً عبر واجهة React.
    
2. **المعالجة:** يستلم Electron الطلب، يقرأ الملف من القرص الصلب، ويمرر السياق للنموذج.
    
3. **الاستجابة والتحليل:** يولد النموذج الرد، وبالتزامن يرسل Electron بيانات العملية (الوقت، استهلاك الموارد) إلى محرك Python.
    
4. **التحديث:** يقوم Python بحساب المقاييس وإعادة النتائج لـ React لتحديث الرسوم البيانية لحظياً، بينما يتم حفظ الرد في ملف Markdown محلي.
![[deepseek_mermaid_20260210_5a184e.svg]]
---
## مخطط تفاعلي بين الطبقات (Layer Interaction Diagram)
![[deepseek_mermaid_20260210_0ade57.svg]]

---
## مخطط إدارة النماذج (Model Management Diagram)
![[deepseek_mermaid_20260210_d7134f.svg]]

---
### الميزات التقنية لهذا الهيكل:

- **الاستقلالية:** لا يتطلب اتصالاً بالإنترنت أو خادم قاعدة بيانات (Zero-Dependency).
    
- **السرعة:** التواصل عبر IPC و Local Files يقلل من زمن التأخير (Latency).
    
- **الشفافية:** يمكن للمستخدم فتح مجلد المشروع ورؤية كافة البيانات والسجلات كملفات عادية.

